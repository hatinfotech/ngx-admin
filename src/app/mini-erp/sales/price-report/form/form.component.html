<nb-card>
  <nb-card-header>Form báo giá</nb-card-header>
  <nb-card-body>
    <form [formGroup]="priceReportForm" (ngSubmit)="onSubmit()">
      <input type="hidden" formControlName="Code">
      <div class="row">
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Tổ chức/Cá nhân</label>
            <!-- <input type="text" id="Object" nbInput fullWidth formControlName="Object" placeholder="Tổ chức/Cá nhân"> -->
            <input type="hidden" formControlName="Object">
            <select2 [value]="objectValue" [data]="customerList" [options]="select2Option" [cssImport]=true
              (valueChanged)="onObjectChange($event)"></select2>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="form-group">
            <label class="label">Tên</label>
            <input type="text" nbInput fullWidth formControlName="ObjectName" placeholder="Tên">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Người nhận</label>
            <input type="email" nbInput fullWidth formControlName="Recipient" placeholder="Người nhận">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-9">
          <div class="form-group">
            <label class="label">Địa chỉ</label>
            <input type="text" nbInput fullWidth formControlName="ObjectAddress" placeholder="Địa chỉ">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Điện thoại</label>
            <input type="text" nbInput fullWidth formControlName="ObjectPhone" placeholder="Điện thoại">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Email</label>
            <input type="text" nbInput fullWidth formControlName="ObjectEmail" placeholder="Email">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">MST</label>
            <!-- <input type="text" nbInput fullWidth formControlName="ObjectTaxCode" placeholder="Mã số thuế"> -->
            <nb-select selected="1" fullWidth formControlName="ObjectTaxCode">
              <nb-option value="1">Chua bao gom 10 %</nb-option>
              <nb-option value="2">Khong VAT</nb-option>
            </nb-select>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Ngân hàng</label>
            <input type="text" nbInput fullWidth formControlName="ObjectBankName" placeholder="Ngân hàng">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Số TK Ngân hàng</label>
            <input type="text" nbInput fullWidth formControlName="ObjectBankCode" placeholder="Số tài khoản ngân hàng">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label class="label">Tiêu đề báo giá</label>
            <input type="text" nbInput fullWidth formControlName="Title" placeholder="Tiêu đề báo giá">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label class="label">Ghi chú</label>
            <textarea nbInput fullWidth formControlName="Note" placeholder="Ghi chú"></textarea>
          </div>
        </div>
      </div>
      <div class="row form-details">
        <div class="col-sm-12">
          <label class="label">Chi tiết hàng hóa</label>
          <div class="row">
            <div class="col-sm-1">STT</div>
            <div class="col-sm-11">
                <div class="row">
                    <!-- <div class="col-sm-1">STT</div> -->
                    <div class="col-sm-2">Diễn giải</div>
                    <div class="col-sm-2">ĐVT</div>
                    <div class="col-sm-2" style="text-align: right;">Số lượng</div>
                    <div class="col-sm-2" style="text-align: right;">Đơn giá</div>
                    <div class="col-sm-2">Thuế</div>
                    <div class="col-sm-2" style="text-align: right;">Thành tiền</div>
                    <!-- <div class="col-sm-1" style="text-align: right;">Lệnh</div> -->
                  </div>
            </div>
          </div>

          <hr>
          <div formArrayName="details" [sortablejs]="details" [sortablejsOptions]="{ handle: '.sorting-handle' }">
            <div class="form-detail-item" *ngFor="let detail of details.controls; let i=index" [formGroup]="detail">
              <div class="row">
                <div class="col-sm-1">
                  <button type="button" class="btn btn-warning" (click)="removeDetail(i)">{{ i+1 }}</button>
                  <button type="button" class="btn btn-primary sorting-handle">MOVE</button>
                </div>
                <div class="col-sm-11">
                  <div class="row">
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Sản phẩm</label>
                        <input style="display: none;" type="hidden" class="form-control" type="text"
                          formControlName="Product" placeholder="Sản phảm">
                        <select2 [options]="select2OptionForProduct" [cssImport]=true
                          (valueChanged)="onObjectChange($event)"></select2>
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">ĐVT</label>
                        <select2 [data]="unitList" [options]="select2OptionForUnit" [cssImport]=true></select2>
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Số lượng</label>
                        <input nbInput fullWidth type="text" formControlName="Quantity" placeholder="Số lượng"
                          style="text-align: right;">
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Đơn giá</label>
                        <input nbInput fullWidth type="text" formControlName="Price" placeholder="Đơn giá"
                          style="text-align: right;">
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Thuế</label>
                        <input nbInput fullWidth type="text" formControlName="Tax" placeholder="Thuế">
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Thành tiền</label>
                        <input nbInput fullWidth type="text" formControlName="ToMoney"
                          [value]=" detail.get('Price').value * detail.get('Quantity').value | number: '3.0-0'"
                          placeholder="Thành tiền" style="text-align: right;">
                      </div>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <label class="label">Sản phẩm</label>
                        <textarea nbInput fullWidth formControlName="Description" placeholder="Diễn giải"></textarea>
                      </div>
                    </div>
                  </div>
                  <hr>
                </div>
              </div>

            </div>
          </div>

        </div>
      </div>
      <div class="btn-group">
        <button type="button" class="btn btn-warning" (click)="addDetail()">Thêm hàng hóa</button>
        <button type="button" class="btn btn-success">Xem trước</button>
        <button type="submit" class="btn btn-primary" [disabled]="!priceReportForm.valid">Lưu</button>
      </div>
    </form>
  </nb-card-body>
</nb-card>
