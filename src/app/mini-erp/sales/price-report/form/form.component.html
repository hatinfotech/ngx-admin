<nb-card>
  <nb-card-header>Form báo giá</nb-card-header>
  <nb-card-body>
    <form [formGroup]="priceReportForm" (ngSubmit)="onSubmit()">
      <input type="hidden" formControlName="Code">
      <div class="row">
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Tổ chức/Cá nhân</label>
            <!-- <input type="text" id="Object" nbInput fullWidth formControlName="Object" placeholder="Tổ chức/Cá nhân"> -->
            <!-- <input type="hidden" formControlName="Object">
            <select2 [value]="objectValue" [data]="customerList" [options]="select2Option" [cssImport]=true
              (valueChanged)="onObjectChange($event)"></select2> -->
            <!-- <select class="js-example-basic-single" name="state">
                  <option value="AL">Alabama</option>

                  <option value="WY">Wyoming</option>
                </select> -->
            <ngx-select2 formControlName="Object" [select2Option]="select2Option"
              (selectChange)="onObjectChange($event)"></ngx-select2>
            <!-- <span>{{provinceEl.touched ? 'touched' : 'none touch'}}</span> -->
          </div>
        </div>
        <div class="col-sm-6">
          <div class="form-group">
            <label class="label">Tên</label>
            <input type="text" nbInput fullWidth formControlName="ObjectName" placeholder="Tên">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Người nhận</label>
            <input type="email" nbInput fullWidth formControlName="Recipient" placeholder="Người nhận">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-9">
          <div class="form-group">
            <label class="label">Địa chỉ</label>
            <input type="text" nbInput fullWidth formControlName="ObjectAddress" placeholder="Địa chỉ">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Điện thoại</label>
            <input type="text" nbInput fullWidth formControlName="ObjectPhone" placeholder="Điện thoại">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Email</label>
            <input type="text" nbInput fullWidth formControlName="ObjectEmail" placeholder="Email">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">MST</label>
            <!-- <input type="text" nbInput fullWidth formControlName="ObjectTaxCode" placeholder="Mã số thuế"> -->
            <nb-select selected="1" fullWidth formControlName="ObjectTaxCode">
              <nb-option value="1">Chua bao gom 10 %</nb-option>
              <nb-option value="2">Khong VAT</nb-option>
            </nb-select>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Ngân hàng</label>
            <input type="text" nbInput fullWidth formControlName="ObjectBankName" placeholder="Ngân hàng">
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label class="label">Số TK Ngân hàng</label>
            <input type="text" nbInput fullWidth formControlName="ObjectBankCode" placeholder="Số tài khoản ngân hàng">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label class="label">Tiêu đề báo giá</label>
            <input type="text" nbInput fullWidth formControlName="Title" placeholder="Tiêu đề báo giá">
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="form-group">
            <label class="label">Ghi chú</label>
            <textarea nbInput fullWidth formControlName="Note" placeholder="Ghi chú"></textarea>
          </div>
        </div>
      </div>
      <div class="row form-details">
        <div class="col-sm-12">
          <label class="label">Chi tiết hàng hóa</label>
          <div class="row">
            <div class="col-sm-1">STT</div>
            <div class="col-sm-11">
              <div class="row">
                <!-- <div class="col-sm-1">STT</div> -->
                <div class="col-sm-2">Diễn giải</div>
                <div class="col-sm-2">ĐVT</div>
                <div class="col-sm-2" style="text-align: right;">Số lượng</div>
                <div class="col-sm-2" style="text-align: right;">Đơn giá</div>
                <div class="col-sm-2">Thuế</div>
                <div class="col-sm-2" style="text-align: right;">Thành tiền</div>
                <!-- <div class="col-sm-1" style="text-align: right;">Lệnh</div> -->
              </div>
            </div>
          </div>

          <hr>
          <div formArrayName="details" [sortablejs]="details" [sortablejsOptions]="{ handle: '.sorting-handle' }">
            <div class="form-detail-item" *ngFor="let detail of details.controls; let i=index" [formGroup]="detail">
              <div class="row">
                <div class="col-sm-1">
                  <div class="form-group">
                    <input nbInput fullWidth disabled="true" value="{{ i + 1 }}" style="text-align: center;">
                  </div>
                  <div class="form-group">
                    <button nbButton status="danger" hero size="tiny" (click)="removeDetail(i)" style="width: 100%;">
                      <nb-icon pack="eva" icon="trash-2-outline"></nb-icon>
                    </button>
                    <button nbButton status="success" hero size="tiny" class="sorting-handle" style="width: 100%;">
                      <nb-icon pack="eva" icon="move-outline"></nb-icon>
                    </button>
                  </div>
                </div>
                <div class="col-sm-11">
                  <div class="row">
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Sản phẩm</label>
                        <!-- <input style="display: none;" type="hidden" class="form-control" type="text"
                          formControlName="Product" placeholder="Sản phảm"> -->
                        <!-- <select2 [options]="select2OptionForProduct" [cssImport]=true
                          (valueChanged)="onObjectChange($event)"></select2> -->
                        <ngx-select2 formControlName="Product" [select2Option]="select2OptionForProduct"
                          (selectChange)="onProductChange($event, i)"></ngx-select2>
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">ĐVT</label>
                        <!-- <input nbInput fullWidth formControlName="Unit" placeholder="ĐVT"> -->
                        <ngx-select2 formControlName="Unit" [select2Option]="select2OptionForUnit"></ngx-select2>
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Số lượng</label>
                        <input nbInput fullWidth type="text" formControlName="Quantity" placeholder="Số lượng"
                          style="text-align: right;">
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Đơn giá</label>
                        <input nbInput fullWidth type="text" formControlName="Price" placeholder="Đơn giá"
                          style="text-align: right;">
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Thuế</label>
                        <input nbInput fullWidth type="text" formControlName="Tax" placeholder="Thuế">
                      </div>
                    </div>
                    <div class="col-sm-2">
                      <div class="form-group">
                        <label class="label">Thành tiền</label>
                        <input nbInput fullWidth type="text" formControlName="ToMoney"
                          [value]=" detail.get('Price').value * detail.get('Quantity').value | number: '3.0-0'"
                          placeholder="Thành tiền" style="text-align: right;">
                      </div>
                    </div>
                    <div class="col-sm-12">
                      <div class="form-group">
                        <label class="label">Sản phẩm</label>
                        <textarea nbInput fullWidth formControlName="Description" placeholder="Diễn giải"></textarea>
                      </div>
                    </div>
                  </div>
                  <hr style="margin-top: 0;">
                </div>
              </div>

            </div>
          </div>

        </div>
      </div>
      <div class="buttons-row" style="text-align: right;">
        <button nbButton status="warning" (click)="addDetail()" hero>Thêm hàng hóa</button>
        <button nbButton status="info" hero>Xem trước</button>
        <button nbButton status="success" [disabled]="!priceReportForm.valid" hero>Lưu báo giá</button>
      </div>
      <!-- <div class="btn-group">
        <button type="button" class="btn btn-warning" (click)="addDetail()">Thêm hàng hóa</button>
        <button type="button" class="btn btn-success">Xem trước</button>
        <button type="submit" class="btn btn-primary" [disabled]="!priceReportForm.valid">Lưu</button>
      </div> -->
    </form>
  </nb-card-body>
</nb-card>
