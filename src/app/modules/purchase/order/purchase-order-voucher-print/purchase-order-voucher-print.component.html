<div class="dialog-wrap {{inputMode}}" #dialogWrap>
  <nb-card *ngFor="let data of this.data; let i=index;" style="max-height: initial; margin: 0 auto; width: 22cm;" class="small-header">
    <nb-card-header>
      <ngx-card-header [option]="{controlOption: {index: i}}" [size]="size" [icon]="favicon" [title]="data['Title'] || ('Purchase.Voucher.title' | translate:{definition: '', action: commonService.translate.instant('Common.print')} | headtitlecase)" [controls]="actionButtonList"></ngx-card-header>
    </nb-card-header>
    <nb-card-body class="print-body" #printContent>
      <div id="print-area">
        <ngx-print-header></ngx-print-header>
        <div>
          <div class="print-title">{{ 'Purchase.Order.title' | translate:{action: '', definition: ''} | uppercase }}
          </div>
          <div class="under-title">{{ data.Code }} - {{ data.DateOfOrder | date:'short' }}</div>
        </div>
        <div>
          <div style="display: flex;">
            <div style="flex: 1;">
              <div class="under-line">{{'Voucher.dearSupplier' | translate | headtitlecase}} :
                {{renderValue(data.ObjectName)}}
              </div>
            </div>
            <div>
              <div class="under-line">{{'Common.phone' | translate | headtitlecase}} :
                {{renderValue(data.ObjectPhone)}}
              </div>
            </div>
            <div>
              <div class="under-line">{{'Common.supplierId' | translate | headtitlecase}} :
                {{renderValue(data.Object | objectid)}}
              </div>
            </div>
          </div>
          <div class="under-line">{{'Common.address' | translate | headtitlecase}} : {{renderValue(data.ObjectAddress)}}</div>
          <ng-container *ngIf="data.Contact">
            <div style="display: flex;">
              <div style="flex: 1;">
                <div class="under-line">{{'Contact.name' | translate | headtitlecase}} :
                  {{renderValue(data.ContactName)}}
                </div>
              </div>
              <div>
                <div class="under-line">{{'Contact.phone' | translate | headtitlecase}} :
                  {{renderValue(data.ContactPhone)}}
                </div>
              </div>
              <div>
                <div class="under-line">{{'Contact.id' | translate | headtitlecase}} :
                  {{renderValue(data.Contact | objectid)}}
                </div>
              </div>
            </div>
            <div class="under-line">{{'Contact.address' | translate | headtitlecase}} : {{renderValue(data.ContactAddress)}}</div>

          </ng-container>
        </div>
        <div>
          <div>
            <table style="width: 100%;" class="print-voucher-detail-table">
              <thead class="print-voucher-detail-header">
                <td>#</td>
                <td>{{'Sku' | translate | headtitlecase}}</td>
                <td>{{'Common.productOrService' | translate | headtitlecase}}</td>
                <td class="text-align-right">{{'Voucher.shortUnit' | translate | headtitlecase}}</td>
                <td class="text-align-right">{{'Voucher.shortQuantity' | translate | headtitlecase}}</td>
                <td class="text-align-right">{{'Voucher.price' | translate | headtitlecase}}</td>
                <td class="text-align-right">{{'Voucher.tax' | translate | headtitlecase}}</td>
                <td class="text-align-right">{{'Voucher.toMoney' | translate | headtitlecase}}</td>
              </thead>
              <tr class="print-voucher-detail-line" *ngFor="let detail of data.Details; let i = index">
                <td>{{detail.No}}</td>
                <td><span>{{detail.Product?.Sku}}</span><span style="font-style: italic; font-size: 0.5rem;"> - ID: {{renderValue(detail.Product | objectid)}}</span></td>
                <td><span class="description" style="cursor: pointer" (click)="updateSalePrice(detail)">{{renderValue(detail.Description)}}</span></td>
                <td class="text-align-right">{{detail.Unit | objecttext}}</td>
                <td class="text-align-right">{{renderValue(detail.Quantity) | number}}</td>
                <td class="text-align-right">{{renderValue(detail.Price) | currency:'VND'}}</td>
                <td class="text-align-right">{{detail.Tax | objecttext}}</td>
                <td class="text-align-right">{{detail['ToMoney'] | currency:'VND'}}</td>
              </tr>
              <tr>
                <td colspan="2">{{'Common.note' | translate | headtitlecase}}</td>
                <td colspan="5" class="text-align-right">{{'Voucher.total' | translate | headtitlecase}}</td>
                <td class="text-align-right">{{data['Total'] | currency:'VND'}}</td>
              </tr>
            </table>
          </div>
        </div>
        <div>
          <div class="under-line" *ngIf="data.Note"><span [innerHTML]="renderValue(data.Note) + '<br>'"></span></div><span style="font-style: italic;">Chú ý: Hàng không đúng quy cách không nhận hàng !</span>
          <!-- <div class="under-line">{{'Purchase.deliveryAddress' | translate | headtitlecase}}: -->
          <!-- {{renderValue(data.DeliveryAddress)}} -->
          <!-- </div> -->
          <!-- <div class="under-line">{{'Sales.directReceiver' | translate | headtitlecase}}:
            {{renderValue(data.DirectReceiverName)}}</div> -->
        </div>
        <div style="display: flex; flex-wrap: wrap">
          <div style="text-align: center; flex: 0 0 50%;">
            <br>
            Bên mua
            <br><br><br>
          </div>
          <div style="text-align: center; flex: 0 0 50%;">
            <br>
            Bên bán
            <br><br><br>
          </div>
        </div>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <div class="buttons-row">
        <button *ngIf="mode === 'print'" nbButton hero status="info" (click)="edit(data);">
          <nb-icon pack="eva" icon="edit"></nb-icon>{{'Common.edit' | translate | headtitlecase}}
        </button>
        <button nbButton hero status="info" (click)="prepareCopy(data);" style="float: left;">
          <nb-icon pack="eva" icon="copy"></nb-icon>{{'Common.copy' | translate | headtitlecase}}
        </button>
        <!-- <button nbButton hero status="primary" (click)="print();" [disabled]="!identifier"><nb-icon pack="eva" icon="printer"></nb-icon>{{'Common.print' | translate | headtitlecase}}</button> -->
        <!-- <button nbButton hero status="info" (click)="exportExcel('excel');">{{'Common.exportTo' | translate:{to: 'Excel'} | headtitlecase}}</button>
            <button nbButton hero status="info" (click)="exportExcel('pdf');">{{'Common.exportTo' | translate:{to: 'PDF'} | headtitlecase}}</button> -->
        <!-- <button nbButton hero status="danger" [disabled]="['COMPLETE'].indexOf(data.State) > -1" (click)="approvedConfirm(data, i);">{{(processMapList[i]?.nextStateLabel || '') | translate | headtitlecase}}<nb-icon pack="eva" icon="skip-forward"></nb-icon></button> -->

        <!--State process buttons-->
        <button *ngFor="let nextState of processMapList[i]?.nextStates" nbButton hero status="{{nextState.status}}" (click)="stateActionConfirm(data, nextState);">{{nextState.confirmLabel | translate | headtitlecase}}<nb-icon pack="{{nextState.iconPack || 'eva'}}" icon="{{nextState.icon || 'skip-forward'}}"></nb-icon></button>
        <!--End State process buttons-->

        <button *ngIf="!sourceOfDialog || sourceOfDialog === 'form'" nbButton hero status="success" (click)="saveAndClose(data);">
          <nb-icon pack="eva" icon="save"></nb-icon>{{'Common.saveAndClose' | translate | headtitlecase}}
        </button>
      </div>
    </nb-card-footer>
  </nb-card>
</div>