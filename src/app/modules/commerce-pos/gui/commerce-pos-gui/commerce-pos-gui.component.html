<div class="pos-wrap scrollable-container" [ngClass]="{'is-fullscreen': isFullscreenMode}" #commercePosGui>
    <audio #newDetailPipSound>
        <source src='assets/sounds/beep-08b.wav' type="audio/mp3">
    </audio>
    <audio #increaseDetailPipSound>
        <source src='assets/sounds/beep-07a.wav' type="audio/mp3">
    </audio>
    <audio #errorSound>
        <source src='assets/sounds/beep-03.wav' type="audio/mp3">
    </audio>
    <nb-card class="small-header smart-table" class="dialog-wrap {{inputMode}}">
        <nb-card-header *ngIf="!this.isFullscreenMode">
            <ngx-card-header [size]="size" [icon]="favicon" [title]="title ? title : (('Máy bán hàng' | translate:{action: '', definition: commonService.translate.instant('Common.table')} | headtitlecase))" [controls]="actionButtonList"></ngx-card-header>
        </nb-card-header>
        <nb-card-body>
            <div class="pos" style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                <div class="pos-header" style="display: flex; align-items: center;">
                    <div class="logo-wrap" style="flex: 1; padding: 0.1rem">
                        <img src="assets/images/logo/logo_probox_one.png" style="height: 35px; margin-left: 1rem;">
                    </div>
                    <div class="info-wrap" style="width: 350px; font-size: 12px; font-weight: bold; line-height: 12px;">
                        <div>Quầy: Quầy 1</div>
                        <div>Leader: Nguyễn Thanh Thúy</div>
                        <div>Follower: Huỳnh Thị Thủy</div>
                    </div>
                    <div class="control-wrap" style="width: 400px;  padding-left: 1rem; padding-right: 1rem;">
                        <div class="row buttons-row">
                            <div class="col-md-4">
                                <button nbButton fullWidth status="info">Quản lý</button>
                            </div>
                            <div class="col-md-4">
                                <button nbButton fullWidth status="primary">Tùy chọn</button>
                            </div>
                            <div class="col-md-4">
                                <button nbButton fullWidth status="danger">Thoát</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pos-container scrollable-container" style="flex: 1; display: flex; flex-direction: row;">
                    <div class="order" style="display: flex; flex-direction: column; flex: 1;">

                        <div class="pos-search" style="display: flex; flex-direction: row; padding: 1rem;">
                            <div class="pos-search-input-wrap" style="flex: 1;">
                                <input id="posSearchInput" (keydown)="onSearchInputKeydown($event)" type="text" nbInput status="primary" size="medium" fullWidth placeholder="Tìm hàng hóa/quét mã vạch..." class="pos-search-input">
                            </div>
                            <div class="pos-search-button-wrap">
                                <button nbButton status="primary" class="pos-search-button" size="medium" style="margin-left: 1rem; width: 50px;">
                                    <nb-icon icon="search-outline"></nb-icon>
                                </button>
                            </div>
                        </div>

                        <div class="pos-order-detail scrollable-container" style="flex: 1; padding: 1rem;">
                            <table style="width: 100%; font-size: 14px; font-weight: bold;" [cellPadding]="5">
                                <thead>
                                    <td style="text-align: center; white-space: nowrap;">Xóa</td>
                                    <td style=" white-space: nowrap;">Hình</td>
                                    <td style=" white-space: nowrap;">Hàng hóa</td>
                                    <td style="text-align: center; white-space: nowrap;">(-)</td>
                                    <td style="text-align: right; white-space: nowrap;">Số lượng</td>
                                    <td style="text-align: center; white-space: nowrap;">+</td>
                                    <td style="text-align: right; white-space: nowrap;">Đơn giá</td>
                                    <td style="text-align: right; white-space: nowrap;">CK(%)</td>
                                    <td style="text-align: right; white-space: nowrap;">Thành tiền</td>
                                </thead>
                                <tr *ngFor="let detail of order.Details; let i = index">
                                    <td style="text-align: center">
                                        <button nbButton status="danger" size="small" (click)="removeDetail(i)">
                                            <nb-icon icon="close-outline"></nb-icon>
                                        </button>
                                    </td>
                                    <td><img src="{{detail.FeaturePicture}}"></td>
                                    <td>{{detail.Description | objecttext}} - SKU: {{detail.Sku}}<br>Số truy xuất: {{detail.AccessNumbers | objectstext}}</td>
                                    <td style="text-align: center">
                                        <button nbButton status="warning" size="small">
                                            <nb-icon icon="minus-outline"></nb-icon>
                                        </button>
                                    </td>
                                    <td style="text-align: right;"><input nbInput [(ngModel)]="detail.Quantity" style="text-align: right; width: 80px;" currencyMask [options]="quantityFormat" (focus)="currencyMaskFocus($event, quantityFormat)" (keydown)="currencyMastKeydown($event, quantityFormat)"></td>
                                    <td style="text-align: center">
                                        <button nbButton status="primary" size="small">
                                            <nb-icon icon="plus-outline"></nb-icon>
                                        </button>
                                    </td>
                                    <td style="text-align: right;">{{detail.Price | currency:'VND'}}</td>
                                    <td style="text-align: right;">{{detail.Discount | number}}</td>
                                    <td style="text-align: right;">{{detail.ToMoney | currency:'VND'}}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="pos-order-summary">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="pos-field" style="display: flex; margin-bottom: 1rem; align-items: center;">
                                        <div class="pos-field-label">Tiền CK</div>
                                        <div class="pos-field-control" style="flex: 1"><input type="text" nbInput fullWidth style="text-align: right" currencyMask [options]="toMoneyCurencyFormat"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="pos-field" style="display: flex; margin-bottom: 1rem;">
                                        <div class="pos-field-label">Tiền VAT</div>
                                        <div class="pos-field-control" style="flex: 1"><input type="text" nbInput fullWidth style="text-align: right" currencyMask [options]="toMoneyCurencyFormat"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="pos-field" style="display: flex; margin-bottom: 1rem;">
                                        <div class="pos-field-label">Tiền hàng</div>
                                        <div class="pos-field-control" style="flex: 1"><input type="text" [(ngModel)]="order.Total" nbInput fullWidth disabled style="text-align: right" currencyMask [options]="toMoneyCurencyFormat"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="pos-field" style="display: flex; margin-bottom: 1rem;">
                                        <div class="pos-field-label">Thanh toán</div>
                                        <div class="pos-field-control" style="flex: 1"><input type="text" nbInput fullWidth style="text-align: right" currencyMask [options]="toMoneyCurencyFormat"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pos-business" style="display: flex; flex-direction: column; padding: 1rem;">
                        <div class="scrollable-container" style="flex: 1; overflow-x: hidden; max-width: initial; margin: initial;">
                            <div class="row">
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="person-outline"></nb-icon>
                                        <div class="button-label">Khách hàng</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Giao hàng</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Ghi chú</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Chiết khấu</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Thuế VAT</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Tiền phí</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Quà tặng</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Hàng hóa</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Tồn kho</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Nhân viên</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Đặt hàng</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Trả hàng</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Lưu tạm</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">--</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="info" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Mở rộng</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="primary" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Đổi trả</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="primary" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Thống kê</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="primary" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Báo cáo</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="primary" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Mở két</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="primary" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Khóa</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="primary" class="pos-business-button">
                                        <nb-icon icon="square-outline"></nb-icon>
                                        <div class="button-label">Đổi user</div>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div style="padding-top: 1rem">
                            <div class="row">
                                <div class="col-xxxl-8">
                                    <button nbButton fullWidth size="medium" status="success" class="pos-business-button">
                                        <nb-icon icon="flash-outline"></nb-icon>
                                        <div class="button-label">Thanh toán</div>
                                    </button>
                                </div>
                                <div class="col-xxxl-4">
                                    <button nbButton fullWidth size="medium" status="danger" class="pos-business-button" (click)="destroyOrder($event)">
                                        <nb-icon icon="close-outline"></nb-icon>
                                        <div class="button-label">Hủy phiếu</div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pos-status" style="display: flex; align-items: center; padding: 0.2rem; padding-left: 1rem;">
                    <div class="status" style="flex: 1;">Online | Lượt khách: 102, Doanh thu: 12.000.000đ</div>
                    <div class="pos-time" style="text-align: right; width: 200px;">{{currentDate | date:'short'}}</div>
                </div>
            </div>
        </nb-card-body>
    </nb-card>
</div>